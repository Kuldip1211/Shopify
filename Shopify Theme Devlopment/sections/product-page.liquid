<!-- üìÑ sections/main-product.liquid -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<section class="product-detail-section" style="font-family:'Poppins',sans-serif; padding:60px 0; background:{{ section.settings.bg_color }};">
  <div class="container" style="max-width:1200px; margin:0 auto; padding:0 20px;">

    {% if product %}
    <div class="product-detail-wrapper">
      
      <!-- üñºÔ∏è Product Images -->
      <div class="product-images">
        <div class="main-image">
          <img id="mainProductImage" src="{{ product.featured_image | img_url: 'large' }}" alt="{{ product.title }}">
        </div>
        <div class="thumbnail-gallery">
          {% for image in product.images %}
            <img src="{{ image | img_url: 'medium' }}" alt="{{ product.title }}" class="thumbnail" onclick="updateMainImage('{{ image | img_url: 'large' }}')">
          {% endfor %}
        </div>
      </div>

      <!-- üßæ Product Info -->
      <div class="product-info">
        <h1 class="product-title">{{ product.title }}</h1>
        <p class="vendor">üë®‚Äçüíº Vendor: {{ product.vendor }}</p>
        <p class="category">üì¶ Category: {{ product.type }}</p>

        {% if product.tags.size > 0 %}
          <p class="tags">üè∑Ô∏è Tags: 
            {% for tag in product.tags %}
              <span class="tag">{{ tag }}</span>
            {% endfor %}
          </p>
        {% endif %}

        <p class="price">üí∞ {{ product.price | money }}</p>

        {% if product.compare_at_price > product.price %}
          <p class="compare-price">Was: {{ product.compare_at_price | money }}</p>
        {% endif %}

        {% if product.description != blank %}
          <div class="description">
            <h3>üìù Description</h3>
            <div>{{ product.description }}</div>
          </div>
        {% endif %}

        <!-- üß© Variants -->
        {% if product.has_only_default_variant == false %}
          <div class="variants">
            <h4>Select Options:</h4>
            <form id="productForm" method="post" action="/cart/add">
              {% for option in product.options_with_values %}
                <label><strong>{{ option.name }}</strong></label>
                <select name="options[{{ option.name }}]" required>
                  {% for value in option.values %}
                    <option value="{{ value }}">{{ value }}</option>
                  {% endfor %}
                </select>
              {% endfor %}
              <input type="hidden" name="id" value="{{ product.variants.first.id }}">
              <button type="submit" class="add-to-cart-btn">üõí Add to Cart</button>
            </form>
          </div>
        {% else %}
          <form method="post" action="/cart/add" class="single-variant-form">
            <input type="hidden" name="id" value="{{ product.variants.first.id }}">
            <button type="submit" class="add-to-cart-btn">üõí Add to Cart</button>
          </form>
        {% endif %}

        <!-- ‚úÖ Inventory Info -->
        <p class="inventory">
          {% if product.available %}
            ‚úÖ In Stock ({{ product.variants.first.inventory_quantity }} available)
          {% else %}
            ‚ùå Out of Stock
          {% endif %}
        </p>
      </div>
    </div>
    {% endif %}
  </div>
</section>

<style>
.product-detail-wrapper {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  align-items: start;
}
.product-images {
  display: flex;
  flex-direction: column;
  gap: 15px;
}
.main-image img {
  width: 100%;
  border-radius: 12px;
  object-fit: cover;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.thumbnail-gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}
.thumbnail {
  width: 80px;
  height: 80px;
  border-radius: 8px;
  cursor: pointer;
  object-fit: cover;
  border: 2px solid transparent;
  transition: all 0.3s;
}
.thumbnail:hover {
  border-color: #27ae60;
  transform: scale(1.05);
}
.product-info h1 {
  font-size: 30px;
  font-weight: 700;
  margin-bottom: 10px;
  color: #222;
}
.vendor, .category, .price, .compare-price {
  font-size: 16px;
  margin-bottom: 8px;
}
.price {
  color: #27ae60;
  font-weight: 700;
  font-size: 22px;
}
.compare-price {
  color: #999;
  text-decoration: line-through;
}
.description {
  margin-top: 20px;
  line-height: 1.6;
}
.tag {
  display: inline-block;
  background: #eafaf1;
  border: 1px solid #27ae60;
  color: #27ae60;
  border-radius: 6px;
  padding: 2px 8px;
  font-size: 12px;
  margin: 2px;
}
.add-to-cart-btn {
  background: #27ae60;
  color: #fff;
  padding: 14px 24px;
  border: none;
  border-radius: 10px;
  font-size: 15px;
  cursor: pointer;
  margin-top: 20px;
  transition: all 0.3s;
  font-weight: 600;
}
.add-to-cart-btn:hover {
  background: #219150;
}
.inventory {
  margin-top: 10px;
  font-size: 14px;
  color: #555;
}
select {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 15px;
}
@media (max-width: 900px) {
  .product-detail-wrapper {
    grid-template-columns: 1fr;
  }
}
</style>

<script>
function updateMainImage(url) {
  document.getElementById("mainProductImage").src = url;
}

// üõí Handle Add to Cart feedback
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll("form[action='/cart/add']").forEach(form => {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = new FormData(form);
      const res = await fetch("/cart/add.js", { method: "POST", body: data });
      if (res.ok) {
        alert("‚úÖ Product added to cart!");
      } else {
        alert("Something went wrong!");
      }
    });
  });
});
</script>

{% schema %}
{
  "name": "Main Product",
  "settings": [
    { "type": "color", "id": "bg_color", "label": "Background Color", "default": "#f9f9f9" }
  ],
  "presets": [{ "name": "Product Detail Page" }]
}
{% endschema %}
